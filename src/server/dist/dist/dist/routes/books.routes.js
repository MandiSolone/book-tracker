"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");
Object.defineProperty(exports, "__esModule", {
  value: true
});
exports["default"] = void 0;
var _regenerator = _interopRequireDefault(require("@babel/runtime/regenerator"));
var _defineProperty2 = _interopRequireDefault(require("@babel/runtime/helpers/defineProperty"));
var _asyncToGenerator2 = _interopRequireDefault(require("@babel/runtime/helpers/asyncToGenerator"));
var _express = _interopRequireDefault(require("express"));
var _books = _interopRequireDefault(require("../controllers/books.controllers"));
function ownKeys(e, r) {
  var t = Object.keys(e);
  if (Object.getOwnPropertySymbols) {
    var o = Object.getOwnPropertySymbols(e);
    r && (o = o.filter(function (r) {
      return Object.getOwnPropertyDescriptor(e, r).enumerable;
    })), t.push.apply(t, o);
  }
  return t;
}
function _objectSpread(e) {
  for (var r = 1; r < arguments.length; r++) {
    var t = null != arguments[r] ? arguments[r] : {};
    r % 2 ? ownKeys(Object(t), !0).forEach(function (r) {
      (0, _defineProperty2["default"])(e, r, t[r]);
    }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(t)) : ownKeys(Object(t)).forEach(function (r) {
      Object.defineProperty(e, r, Object.getOwnPropertyDescriptor(t, r));
    });
  }
  return e;
}

// Requests will reach these routes already matching /api/books
var BooksRouter = _express["default"].Router();

//? means id is optional
BooksRouter.get("/:book_id?", /*#__PURE__*/function () {
  var _ref = (0, _asyncToGenerator2["default"])(/*#__PURE__*/_regenerator["default"].mark(function _callee(req, res, next) {
    var userId, book_id, formatBookData, data, booksList;
    return _regenerator["default"].wrap(function _callee$(_context) {
      while (1) switch (_context.prev = _context.next) {
        case 0:
          if (req.isAuthenticated()) {
            _context.next = 2;
            break;
          }
          return _context.abrupt("return", res.status(401).json({
            message: "User not authenticated"
          }));
        case 2:
          userId = req.user.id; // This comes from the session/auth middleware
          book_id = req.params.book_id;
          _context.prev = 4;
          formatBookData = function formatBookData(book) {
            return {
              book_id: book.book_id,
              user_id: book.user_id,
              title: book.title,
              authors: book.authors,
              comments: book.comments,
              link: book.link,
              image: book.image,
              google_id: book.google_id,
              type: book.type,
              location: book.location,
              status: book.status,
              rating: book.rating
            };
          };
          if (!book_id) {
            _context.next = 15;
            break;
          }
          _context.next = 9;
          return _books["default"].findOne(book_id, userId);
        case 9:
          data = _context.sent;
          if (data) {
            _context.next = 12;
            break;
          }
          return _context.abrupt("return", res.status(404).json({
            message: "Book not found"
          }));
        case 12:
          return _context.abrupt("return", res.json(formatBookData(data)));
        case 15:
          _context.next = 17;
          return _books["default"].findAll({
            user_id: userId
          });
        case 17:
          booksList = _context.sent;
          return _context.abrupt("return", res.json(booksList.map(formatBookData)));
        case 19:
          _context.next = 25;
          break;
        case 21:
          _context.prev = 21;
          _context.t0 = _context["catch"](4);
          console.error("Error fetching book data:", _context.t0);
          return _context.abrupt("return", next(_context.t0));
        case 25:
        case "end":
          return _context.stop();
      }
    }, _callee, null, [[4, 21]]);
  }));
  return function (_x, _x2, _x3) {
    return _ref.apply(this, arguments);
  };
}());
BooksRouter.post("/", /*#__PURE__*/function () {
  var _ref2 = (0, _asyncToGenerator2["default"])(/*#__PURE__*/_regenerator["default"].mark(function _callee2(req, res, next) {
    var userId, newBook, bookWithUserId, data;
    return _regenerator["default"].wrap(function _callee2$(_context2) {
      while (1) switch (_context2.prev = _context2.next) {
        case 0:
          if (req.isAuthenticated()) {
            _context2.next = 2;
            break;
          }
          return _context2.abrupt("return", res.status(401).json({
            message: "User not authenticated"
          }));
        case 2:
          userId = req.user.id;
          newBook = req.body;
          _context2.prev = 4;

          // Include user_id in the book data
          bookWithUserId = _objectSpread(_objectSpread({}, newBook), {}, {
            user_id: userId // Add the user ID to the new book data
          });
          _context2.next = 8;
          return _books["default"].addOne(bookWithUserId);
        case 8:
          data = _context2.sent; // Pass newBook to addOne

          res.status(201).json({
            id: data.book_id,
            title: data.title,
            user_id: data.user_id,
            authors: data.authors || [],
            comments: data.comments,
            link: data.link,
            image: data.image,
            google_id: data.google_id,
            type: data.type,
            location: data.location,
            status: data.status,
            rating: data.rating
          });
          _context2.next = 15;
          break;
        case 12:
          _context2.prev = 12;
          _context2.t0 = _context2["catch"](4);
          next(_context2.t0);
        case 15:
        case "end":
          return _context2.stop();
      }
    }, _callee2, null, [[4, 12]]);
  }));
  return function (_x4, _x5, _x6) {
    return _ref2.apply(this, arguments);
  };
}());
BooksRouter["delete"]("/:book_id", /*#__PURE__*/function () {
  var _ref3 = (0, _asyncToGenerator2["default"])(/*#__PURE__*/_regenerator["default"].mark(function _callee3(req, res, next) {
    var book_id;
    return _regenerator["default"].wrap(function _callee3$(_context3) {
      while (1) switch (_context3.prev = _context3.next) {
        case 0:
          _context3.prev = 0;
          book_id = req.params.book_id;
          _context3.next = 4;
          return _books["default"].removeOne(book_id);
        case 4:
          res.json({
            message: "Book deleted",
            book_id: book_id
          });
          _context3.next = 10;
          break;
        case 7:
          _context3.prev = 7;
          _context3.t0 = _context3["catch"](0);
          next(_context3.t0);
        case 10:
        case "end":
          return _context3.stop();
      }
    }, _callee3, null, [[0, 7]]);
  }));
  return function (_x7, _x8, _x9) {
    return _ref3.apply(this, arguments);
  };
}());
BooksRouter.put("/:book_id", /*#__PURE__*/function () {
  var _ref4 = (0, _asyncToGenerator2["default"])(/*#__PURE__*/_regenerator["default"].mark(function _callee4(req, res, next) {
    var userId, updatedBook, book_id, updatedResult;
    return _regenerator["default"].wrap(function _callee4$(_context4) {
      while (1) switch (_context4.prev = _context4.next) {
        case 0:
          if (req.isAuthenticated()) {
            _context4.next = 2;
            break;
          }
          return _context4.abrupt("return", res.status(401).json({
            message: "User not authenticated"
          }));
        case 2:
          userId = req.user.id;
          updatedBook = req.body; // Get updated book data from request body
          book_id = req.params.book_id; // Extract book_id from request param
          _context4.prev = 5;
          _context4.next = 8;
          return _books["default"].updateOne(updatedBook, book_id, userId);
        case 8:
          updatedResult = _context4.sent;
          if (updatedResult.affectedRows) {
            _context4.next = 11;
            break;
          }
          return _context4.abrupt("return", res.status(404).json({
            message: "Book not found or no changes made."
          }));
        case 11:
          // Respond with the updated book data
          res.json({
            id: updatedResult.book_id,
            user_id: updatedResult.user_id,
            title: updatedResult.title,
            authors: updatedResult.authors ? updatedResult.authors.split(", ") : [],
            // split works as input if a string
            comments: updatedResult.comments,
            link: updatedResult.link,
            image: updatedResult.image,
            google_id: updatedResult.google_id,
            type: updatedResult.type,
            location: updatedResult.location,
            status: updatedResult.status,
            rating: updatedResult.rating
          });
          _context4.next = 18;
          break;
        case 14:
          _context4.prev = 14;
          _context4.t0 = _context4["catch"](5);
          console.error(_context4.t0);
          next(_context4.t0);
        case 18:
        case "end":
          return _context4.stop();
      }
    }, _callee4, null, [[5, 14]]);
  }));
  return function (_x10, _x11, _x12) {
    return _ref4.apply(this, arguments);
  };
}());
var _default = exports["default"] = BooksRouter;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0IiwicmVxdWlyZSIsIk9iamVjdCIsImRlZmluZVByb3BlcnR5IiwiZXhwb3J0cyIsInZhbHVlIiwiX3JlZ2VuZXJhdG9yIiwiX2RlZmluZVByb3BlcnR5MiIsIl9hc3luY1RvR2VuZXJhdG9yMiIsIl9leHByZXNzIiwiX2Jvb2tzIiwib3duS2V5cyIsImUiLCJyIiwidCIsImtleXMiLCJnZXRPd25Qcm9wZXJ0eVN5bWJvbHMiLCJvIiwiZmlsdGVyIiwiZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yIiwiZW51bWVyYWJsZSIsInB1c2giLCJhcHBseSIsIl9vYmplY3RTcHJlYWQiLCJhcmd1bWVudHMiLCJsZW5ndGgiLCJmb3JFYWNoIiwiZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9ycyIsImRlZmluZVByb3BlcnRpZXMiLCJCb29rc1JvdXRlciIsIlJvdXRlciIsImdldCIsIl9yZWYiLCJtYXJrIiwiX2NhbGxlZSIsInJlcSIsInJlcyIsIm5leHQiLCJ1c2VySWQiLCJib29rX2lkIiwiZm9ybWF0Qm9va0RhdGEiLCJkYXRhIiwiYm9va3NMaXN0Iiwid3JhcCIsIl9jYWxsZWUkIiwiX2NvbnRleHQiLCJwcmV2IiwiaXNBdXRoZW50aWNhdGVkIiwiYWJydXB0Iiwic3RhdHVzIiwianNvbiIsIm1lc3NhZ2UiLCJ1c2VyIiwiaWQiLCJwYXJhbXMiLCJib29rIiwidXNlcl9pZCIsInRpdGxlIiwiYXV0aG9ycyIsImNvbW1lbnRzIiwibGluayIsImltYWdlIiwiZ29vZ2xlX2lkIiwidHlwZSIsImxvY2F0aW9uIiwicmF0aW5nIiwiZmluZE9uZSIsInNlbnQiLCJmaW5kQWxsIiwibWFwIiwidDAiLCJjb25zb2xlIiwiZXJyb3IiLCJzdG9wIiwiX3giLCJfeDIiLCJfeDMiLCJwb3N0IiwiX3JlZjIiLCJfY2FsbGVlMiIsIm5ld0Jvb2siLCJib29rV2l0aFVzZXJJZCIsIl9jYWxsZWUyJCIsIl9jb250ZXh0MiIsImJvZHkiLCJhZGRPbmUiLCJfeDQiLCJfeDUiLCJfeDYiLCJfcmVmMyIsIl9jYWxsZWUzIiwiX2NhbGxlZTMkIiwiX2NvbnRleHQzIiwicmVtb3ZlT25lIiwiX3g3IiwiX3g4IiwiX3g5IiwicHV0IiwiX3JlZjQiLCJfY2FsbGVlNCIsInVwZGF0ZWRCb29rIiwidXBkYXRlZFJlc3VsdCIsIl9jYWxsZWU0JCIsIl9jb250ZXh0NCIsInVwZGF0ZU9uZSIsImFmZmVjdGVkUm93cyIsInNwbGl0IiwiX3gxMCIsIl94MTEiLCJfeDEyIiwiX2RlZmF1bHQiXSwic291cmNlcyI6WyIuLi8uLi9yb3V0ZXMvYm9va3Mucm91dGVzLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIlwidXNlIHN0cmljdFwiO1xuXG52YXIgX2ludGVyb3BSZXF1aXJlRGVmYXVsdCA9IHJlcXVpcmUoXCJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2ludGVyb3BSZXF1aXJlRGVmYXVsdFwiKTtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzW1wiZGVmYXVsdFwiXSA9IHZvaWQgMDtcbnZhciBfcmVnZW5lcmF0b3IgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCJAYmFiZWwvcnVudGltZS9yZWdlbmVyYXRvclwiKSk7XG52YXIgX2RlZmluZVByb3BlcnR5MiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvZGVmaW5lUHJvcGVydHlcIikpO1xudmFyIF9hc3luY1RvR2VuZXJhdG9yMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvYXN5bmNUb0dlbmVyYXRvclwiKSk7XG52YXIgX2V4cHJlc3MgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCJleHByZXNzXCIpKTtcbnZhciBfYm9va3MgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCIuLi9jb250cm9sbGVycy9ib29rcy5jb250cm9sbGVyc1wiKSk7XG5mdW5jdGlvbiBvd25LZXlzKGUsIHIpIHtcbiAgdmFyIHQgPSBPYmplY3Qua2V5cyhlKTtcbiAgaWYgKE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMpIHtcbiAgICB2YXIgbyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMoZSk7XG4gICAgciAmJiAobyA9IG8uZmlsdGVyKGZ1bmN0aW9uIChyKSB7XG4gICAgICByZXR1cm4gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihlLCByKS5lbnVtZXJhYmxlO1xuICAgIH0pKSwgdC5wdXNoLmFwcGx5KHQsIG8pO1xuICB9XG4gIHJldHVybiB0O1xufVxuZnVuY3Rpb24gX29iamVjdFNwcmVhZChlKSB7XG4gIGZvciAodmFyIHIgPSAxOyByIDwgYXJndW1lbnRzLmxlbmd0aDsgcisrKSB7XG4gICAgdmFyIHQgPSBudWxsICE9IGFyZ3VtZW50c1tyXSA/IGFyZ3VtZW50c1tyXSA6IHt9O1xuICAgIHIgJSAyID8gb3duS2V5cyhPYmplY3QodCksICEwKS5mb3JFYWNoKGZ1bmN0aW9uIChyKSB7XG4gICAgICAoMCwgX2RlZmluZVByb3BlcnR5MltcImRlZmF1bHRcIl0pKGUsIHIsIHRbcl0pO1xuICAgIH0pIDogT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcnMgPyBPYmplY3QuZGVmaW5lUHJvcGVydGllcyhlLCBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9ycyh0KSkgOiBvd25LZXlzKE9iamVjdCh0KSkuZm9yRWFjaChmdW5jdGlvbiAocikge1xuICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGUsIHIsIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IodCwgcikpO1xuICAgIH0pO1xuICB9XG4gIHJldHVybiBlO1xufVxuXG4vLyBSZXF1ZXN0cyB3aWxsIHJlYWNoIHRoZXNlIHJvdXRlcyBhbHJlYWR5IG1hdGNoaW5nIC9hcGkvYm9va3NcbnZhciBCb29rc1JvdXRlciA9IF9leHByZXNzW1wiZGVmYXVsdFwiXS5Sb3V0ZXIoKTtcblxuLy8/IG1lYW5zIGlkIGlzIG9wdGlvbmFsXG5Cb29rc1JvdXRlci5nZXQoXCIvOmJvb2tfaWQ/XCIsIC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoKSB7XG4gIHZhciBfcmVmID0gKDAsIF9hc3luY1RvR2VuZXJhdG9yMltcImRlZmF1bHRcIl0pKC8qI19fUFVSRV9fKi9fcmVnZW5lcmF0b3JbXCJkZWZhdWx0XCJdLm1hcmsoZnVuY3Rpb24gX2NhbGxlZShyZXEsIHJlcywgbmV4dCkge1xuICAgIHZhciB1c2VySWQsIGJvb2tfaWQsIGZvcm1hdEJvb2tEYXRhLCBkYXRhLCBib29rc0xpc3Q7XG4gICAgcmV0dXJuIF9yZWdlbmVyYXRvcltcImRlZmF1bHRcIl0ud3JhcChmdW5jdGlvbiBfY2FsbGVlJChfY29udGV4dCkge1xuICAgICAgd2hpbGUgKDEpIHN3aXRjaCAoX2NvbnRleHQucHJldiA9IF9jb250ZXh0Lm5leHQpIHtcbiAgICAgICAgY2FzZSAwOlxuICAgICAgICAgIGlmIChyZXEuaXNBdXRoZW50aWNhdGVkKCkpIHtcbiAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAyO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuICAgICAgICAgIHJldHVybiBfY29udGV4dC5hYnJ1cHQoXCJyZXR1cm5cIiwgcmVzLnN0YXR1cyg0MDEpLmpzb24oe1xuICAgICAgICAgICAgbWVzc2FnZTogXCJVc2VyIG5vdCBhdXRoZW50aWNhdGVkXCJcbiAgICAgICAgICB9KSk7XG4gICAgICAgIGNhc2UgMjpcbiAgICAgICAgICB1c2VySWQgPSByZXEudXNlci5pZDsgLy8gVGhpcyBjb21lcyBmcm9tIHRoZSBzZXNzaW9uL2F1dGggbWlkZGxld2FyZVxuICAgICAgICAgIGJvb2tfaWQgPSByZXEucGFyYW1zLmJvb2tfaWQ7XG4gICAgICAgICAgX2NvbnRleHQucHJldiA9IDQ7XG4gICAgICAgICAgZm9ybWF0Qm9va0RhdGEgPSBmdW5jdGlvbiBmb3JtYXRCb29rRGF0YShib29rKSB7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICBib29rX2lkOiBib29rLmJvb2tfaWQsXG4gICAgICAgICAgICAgIHVzZXJfaWQ6IGJvb2sudXNlcl9pZCxcbiAgICAgICAgICAgICAgdGl0bGU6IGJvb2sudGl0bGUsXG4gICAgICAgICAgICAgIGF1dGhvcnM6IGJvb2suYXV0aG9ycyxcbiAgICAgICAgICAgICAgY29tbWVudHM6IGJvb2suY29tbWVudHMsXG4gICAgICAgICAgICAgIGxpbms6IGJvb2subGluayxcbiAgICAgICAgICAgICAgaW1hZ2U6IGJvb2suaW1hZ2UsXG4gICAgICAgICAgICAgIGdvb2dsZV9pZDogYm9vay5nb29nbGVfaWQsXG4gICAgICAgICAgICAgIHR5cGU6IGJvb2sudHlwZSxcbiAgICAgICAgICAgICAgbG9jYXRpb246IGJvb2subG9jYXRpb24sXG4gICAgICAgICAgICAgIHN0YXR1czogYm9vay5zdGF0dXMsXG4gICAgICAgICAgICAgIHJhdGluZzogYm9vay5yYXRpbmdcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgfTtcbiAgICAgICAgICBpZiAoIWJvb2tfaWQpIHtcbiAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAxNTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIH1cbiAgICAgICAgICBfY29udGV4dC5uZXh0ID0gOTtcbiAgICAgICAgICByZXR1cm4gX2Jvb2tzW1wiZGVmYXVsdFwiXS5maW5kT25lKGJvb2tfaWQsIHVzZXJJZCk7XG4gICAgICAgIGNhc2UgOTpcbiAgICAgICAgICBkYXRhID0gX2NvbnRleHQuc2VudDtcbiAgICAgICAgICBpZiAoZGF0YSkge1xuICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDEyO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuICAgICAgICAgIHJldHVybiBfY29udGV4dC5hYnJ1cHQoXCJyZXR1cm5cIiwgcmVzLnN0YXR1cyg0MDQpLmpzb24oe1xuICAgICAgICAgICAgbWVzc2FnZTogXCJCb29rIG5vdCBmb3VuZFwiXG4gICAgICAgICAgfSkpO1xuICAgICAgICBjYXNlIDEyOlxuICAgICAgICAgIHJldHVybiBfY29udGV4dC5hYnJ1cHQoXCJyZXR1cm5cIiwgcmVzLmpzb24oZm9ybWF0Qm9va0RhdGEoZGF0YSkpKTtcbiAgICAgICAgY2FzZSAxNTpcbiAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMTc7XG4gICAgICAgICAgcmV0dXJuIF9ib29rc1tcImRlZmF1bHRcIl0uZmluZEFsbCh7XG4gICAgICAgICAgICB1c2VyX2lkOiB1c2VySWRcbiAgICAgICAgICB9KTtcbiAgICAgICAgY2FzZSAxNzpcbiAgICAgICAgICBib29rc0xpc3QgPSBfY29udGV4dC5zZW50O1xuICAgICAgICAgIHJldHVybiBfY29udGV4dC5hYnJ1cHQoXCJyZXR1cm5cIiwgcmVzLmpzb24oYm9va3NMaXN0Lm1hcChmb3JtYXRCb29rRGF0YSkpKTtcbiAgICAgICAgY2FzZSAxOTpcbiAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMjU7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgMjE6XG4gICAgICAgICAgX2NvbnRleHQucHJldiA9IDIxO1xuICAgICAgICAgIF9jb250ZXh0LnQwID0gX2NvbnRleHRbXCJjYXRjaFwiXSg0KTtcbiAgICAgICAgICBjb25zb2xlLmVycm9yKFwiRXJyb3IgZmV0Y2hpbmcgYm9vayBkYXRhOlwiLCBfY29udGV4dC50MCk7XG4gICAgICAgICAgcmV0dXJuIF9jb250ZXh0LmFicnVwdChcInJldHVyblwiLCBuZXh0KF9jb250ZXh0LnQwKSk7XG4gICAgICAgIGNhc2UgMjU6XG4gICAgICAgIGNhc2UgXCJlbmRcIjpcbiAgICAgICAgICByZXR1cm4gX2NvbnRleHQuc3RvcCgpO1xuICAgICAgfVxuICAgIH0sIF9jYWxsZWUsIG51bGwsIFtbNCwgMjFdXSk7XG4gIH0pKTtcbiAgcmV0dXJuIGZ1bmN0aW9uIChfeCwgX3gyLCBfeDMpIHtcbiAgICByZXR1cm4gX3JlZi5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICB9O1xufSgpKTtcbkJvb2tzUm91dGVyLnBvc3QoXCIvXCIsIC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoKSB7XG4gIHZhciBfcmVmMiA9ICgwLCBfYXN5bmNUb0dlbmVyYXRvcjJbXCJkZWZhdWx0XCJdKSgvKiNfX1BVUkVfXyovX3JlZ2VuZXJhdG9yW1wiZGVmYXVsdFwiXS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUyKHJlcSwgcmVzLCBuZXh0KSB7XG4gICAgdmFyIHVzZXJJZCwgbmV3Qm9vaywgYm9va1dpdGhVc2VySWQsIGRhdGE7XG4gICAgcmV0dXJuIF9yZWdlbmVyYXRvcltcImRlZmF1bHRcIl0ud3JhcChmdW5jdGlvbiBfY2FsbGVlMiQoX2NvbnRleHQyKSB7XG4gICAgICB3aGlsZSAoMSkgc3dpdGNoIChfY29udGV4dDIucHJldiA9IF9jb250ZXh0Mi5uZXh0KSB7XG4gICAgICAgIGNhc2UgMDpcbiAgICAgICAgICBpZiAocmVxLmlzQXV0aGVudGljYXRlZCgpKSB7XG4gICAgICAgICAgICBfY29udGV4dDIubmV4dCA9IDI7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICB9XG4gICAgICAgICAgcmV0dXJuIF9jb250ZXh0Mi5hYnJ1cHQoXCJyZXR1cm5cIiwgcmVzLnN0YXR1cyg0MDEpLmpzb24oe1xuICAgICAgICAgICAgbWVzc2FnZTogXCJVc2VyIG5vdCBhdXRoZW50aWNhdGVkXCJcbiAgICAgICAgICB9KSk7XG4gICAgICAgIGNhc2UgMjpcbiAgICAgICAgICB1c2VySWQgPSByZXEudXNlci5pZDtcbiAgICAgICAgICBuZXdCb29rID0gcmVxLmJvZHk7XG4gICAgICAgICAgX2NvbnRleHQyLnByZXYgPSA0O1xuXG4gICAgICAgICAgLy8gSW5jbHVkZSB1c2VyX2lkIGluIHRoZSBib29rIGRhdGFcbiAgICAgICAgICBib29rV2l0aFVzZXJJZCA9IF9vYmplY3RTcHJlYWQoX29iamVjdFNwcmVhZCh7fSwgbmV3Qm9vayksIHt9LCB7XG4gICAgICAgICAgICB1c2VyX2lkOiB1c2VySWQgLy8gQWRkIHRoZSB1c2VyIElEIHRvIHRoZSBuZXcgYm9vayBkYXRhXG4gICAgICAgICAgfSk7XG4gICAgICAgICAgX2NvbnRleHQyLm5leHQgPSA4O1xuICAgICAgICAgIHJldHVybiBfYm9va3NbXCJkZWZhdWx0XCJdLmFkZE9uZShib29rV2l0aFVzZXJJZCk7XG4gICAgICAgIGNhc2UgODpcbiAgICAgICAgICBkYXRhID0gX2NvbnRleHQyLnNlbnQ7IC8vIFBhc3MgbmV3Qm9vayB0byBhZGRPbmVcblxuICAgICAgICAgIHJlcy5zdGF0dXMoMjAxKS5qc29uKHtcbiAgICAgICAgICAgIGlkOiBkYXRhLmJvb2tfaWQsXG4gICAgICAgICAgICB0aXRsZTogZGF0YS50aXRsZSxcbiAgICAgICAgICAgIHVzZXJfaWQ6IGRhdGEudXNlcl9pZCxcbiAgICAgICAgICAgIGF1dGhvcnM6IGRhdGEuYXV0aG9ycyB8fCBbXSxcbiAgICAgICAgICAgIGNvbW1lbnRzOiBkYXRhLmNvbW1lbnRzLFxuICAgICAgICAgICAgbGluazogZGF0YS5saW5rLFxuICAgICAgICAgICAgaW1hZ2U6IGRhdGEuaW1hZ2UsXG4gICAgICAgICAgICBnb29nbGVfaWQ6IGRhdGEuZ29vZ2xlX2lkLFxuICAgICAgICAgICAgdHlwZTogZGF0YS50eXBlLFxuICAgICAgICAgICAgbG9jYXRpb246IGRhdGEubG9jYXRpb24sXG4gICAgICAgICAgICBzdGF0dXM6IGRhdGEuc3RhdHVzLFxuICAgICAgICAgICAgcmF0aW5nOiBkYXRhLnJhdGluZ1xuICAgICAgICAgIH0pO1xuICAgICAgICAgIF9jb250ZXh0Mi5uZXh0ID0gMTU7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgMTI6XG4gICAgICAgICAgX2NvbnRleHQyLnByZXYgPSAxMjtcbiAgICAgICAgICBfY29udGV4dDIudDAgPSBfY29udGV4dDJbXCJjYXRjaFwiXSg0KTtcbiAgICAgICAgICBuZXh0KF9jb250ZXh0Mi50MCk7XG4gICAgICAgIGNhc2UgMTU6XG4gICAgICAgIGNhc2UgXCJlbmRcIjpcbiAgICAgICAgICByZXR1cm4gX2NvbnRleHQyLnN0b3AoKTtcbiAgICAgIH1cbiAgICB9LCBfY2FsbGVlMiwgbnVsbCwgW1s0LCAxMl1dKTtcbiAgfSkpO1xuICByZXR1cm4gZnVuY3Rpb24gKF94NCwgX3g1LCBfeDYpIHtcbiAgICByZXR1cm4gX3JlZjIuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgfTtcbn0oKSk7XG5Cb29rc1JvdXRlcltcImRlbGV0ZVwiXShcIi86Ym9va19pZFwiLCAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKCkge1xuICB2YXIgX3JlZjMgPSAoMCwgX2FzeW5jVG9HZW5lcmF0b3IyW1wiZGVmYXVsdFwiXSkoLyojX19QVVJFX18qL19yZWdlbmVyYXRvcltcImRlZmF1bHRcIl0ubWFyayhmdW5jdGlvbiBfY2FsbGVlMyhyZXEsIHJlcywgbmV4dCkge1xuICAgIHZhciBib29rX2lkO1xuICAgIHJldHVybiBfcmVnZW5lcmF0b3JbXCJkZWZhdWx0XCJdLndyYXAoZnVuY3Rpb24gX2NhbGxlZTMkKF9jb250ZXh0Mykge1xuICAgICAgd2hpbGUgKDEpIHN3aXRjaCAoX2NvbnRleHQzLnByZXYgPSBfY29udGV4dDMubmV4dCkge1xuICAgICAgICBjYXNlIDA6XG4gICAgICAgICAgX2NvbnRleHQzLnByZXYgPSAwO1xuICAgICAgICAgIGJvb2tfaWQgPSByZXEucGFyYW1zLmJvb2tfaWQ7XG4gICAgICAgICAgX2NvbnRleHQzLm5leHQgPSA0O1xuICAgICAgICAgIHJldHVybiBfYm9va3NbXCJkZWZhdWx0XCJdLnJlbW92ZU9uZShib29rX2lkKTtcbiAgICAgICAgY2FzZSA0OlxuICAgICAgICAgIHJlcy5qc29uKHtcbiAgICAgICAgICAgIG1lc3NhZ2U6IFwiQm9vayBkZWxldGVkXCIsXG4gICAgICAgICAgICBib29rX2lkOiBib29rX2lkXG4gICAgICAgICAgfSk7XG4gICAgICAgICAgX2NvbnRleHQzLm5leHQgPSAxMDtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSA3OlxuICAgICAgICAgIF9jb250ZXh0My5wcmV2ID0gNztcbiAgICAgICAgICBfY29udGV4dDMudDAgPSBfY29udGV4dDNbXCJjYXRjaFwiXSgwKTtcbiAgICAgICAgICBuZXh0KF9jb250ZXh0My50MCk7XG4gICAgICAgIGNhc2UgMTA6XG4gICAgICAgIGNhc2UgXCJlbmRcIjpcbiAgICAgICAgICByZXR1cm4gX2NvbnRleHQzLnN0b3AoKTtcbiAgICAgIH1cbiAgICB9LCBfY2FsbGVlMywgbnVsbCwgW1swLCA3XV0pO1xuICB9KSk7XG4gIHJldHVybiBmdW5jdGlvbiAoX3g3LCBfeDgsIF94OSkge1xuICAgIHJldHVybiBfcmVmMy5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICB9O1xufSgpKTtcbkJvb2tzUm91dGVyLnB1dChcIi86Ym9va19pZFwiLCAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKCkge1xuICB2YXIgX3JlZjQgPSAoMCwgX2FzeW5jVG9HZW5lcmF0b3IyW1wiZGVmYXVsdFwiXSkoLyojX19QVVJFX18qL19yZWdlbmVyYXRvcltcImRlZmF1bHRcIl0ubWFyayhmdW5jdGlvbiBfY2FsbGVlNChyZXEsIHJlcywgbmV4dCkge1xuICAgIHZhciB1c2VySWQsIHVwZGF0ZWRCb29rLCBib29rX2lkLCB1cGRhdGVkUmVzdWx0O1xuICAgIHJldHVybiBfcmVnZW5lcmF0b3JbXCJkZWZhdWx0XCJdLndyYXAoZnVuY3Rpb24gX2NhbGxlZTQkKF9jb250ZXh0NCkge1xuICAgICAgd2hpbGUgKDEpIHN3aXRjaCAoX2NvbnRleHQ0LnByZXYgPSBfY29udGV4dDQubmV4dCkge1xuICAgICAgICBjYXNlIDA6XG4gICAgICAgICAgaWYgKHJlcS5pc0F1dGhlbnRpY2F0ZWQoKSkge1xuICAgICAgICAgICAgX2NvbnRleHQ0Lm5leHQgPSAyO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuICAgICAgICAgIHJldHVybiBfY29udGV4dDQuYWJydXB0KFwicmV0dXJuXCIsIHJlcy5zdGF0dXMoNDAxKS5qc29uKHtcbiAgICAgICAgICAgIG1lc3NhZ2U6IFwiVXNlciBub3QgYXV0aGVudGljYXRlZFwiXG4gICAgICAgICAgfSkpO1xuICAgICAgICBjYXNlIDI6XG4gICAgICAgICAgdXNlcklkID0gcmVxLnVzZXIuaWQ7XG4gICAgICAgICAgdXBkYXRlZEJvb2sgPSByZXEuYm9keTsgLy8gR2V0IHVwZGF0ZWQgYm9vayBkYXRhIGZyb20gcmVxdWVzdCBib2R5XG4gICAgICAgICAgYm9va19pZCA9IHJlcS5wYXJhbXMuYm9va19pZDsgLy8gRXh0cmFjdCBib29rX2lkIGZyb20gcmVxdWVzdCBwYXJhbVxuICAgICAgICAgIF9jb250ZXh0NC5wcmV2ID0gNTtcbiAgICAgICAgICBfY29udGV4dDQubmV4dCA9IDg7XG4gICAgICAgICAgcmV0dXJuIF9ib29rc1tcImRlZmF1bHRcIl0udXBkYXRlT25lKHVwZGF0ZWRCb29rLCBib29rX2lkLCB1c2VySWQpO1xuICAgICAgICBjYXNlIDg6XG4gICAgICAgICAgdXBkYXRlZFJlc3VsdCA9IF9jb250ZXh0NC5zZW50O1xuICAgICAgICAgIGlmICh1cGRhdGVkUmVzdWx0LmFmZmVjdGVkUm93cykge1xuICAgICAgICAgICAgX2NvbnRleHQ0Lm5leHQgPSAxMTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIH1cbiAgICAgICAgICByZXR1cm4gX2NvbnRleHQ0LmFicnVwdChcInJldHVyblwiLCByZXMuc3RhdHVzKDQwNCkuanNvbih7XG4gICAgICAgICAgICBtZXNzYWdlOiBcIkJvb2sgbm90IGZvdW5kIG9yIG5vIGNoYW5nZXMgbWFkZS5cIlxuICAgICAgICAgIH0pKTtcbiAgICAgICAgY2FzZSAxMTpcbiAgICAgICAgICAvLyBSZXNwb25kIHdpdGggdGhlIHVwZGF0ZWQgYm9vayBkYXRhXG4gICAgICAgICAgcmVzLmpzb24oe1xuICAgICAgICAgICAgaWQ6IHVwZGF0ZWRSZXN1bHQuYm9va19pZCxcbiAgICAgICAgICAgIHVzZXJfaWQ6IHVwZGF0ZWRSZXN1bHQudXNlcl9pZCxcbiAgICAgICAgICAgIHRpdGxlOiB1cGRhdGVkUmVzdWx0LnRpdGxlLFxuICAgICAgICAgICAgYXV0aG9yczogdXBkYXRlZFJlc3VsdC5hdXRob3JzID8gdXBkYXRlZFJlc3VsdC5hdXRob3JzLnNwbGl0KFwiLCBcIikgOiBbXSxcbiAgICAgICAgICAgIC8vIHNwbGl0IHdvcmtzIGFzIGlucHV0IGlmIGEgc3RyaW5nXG4gICAgICAgICAgICBjb21tZW50czogdXBkYXRlZFJlc3VsdC5jb21tZW50cyxcbiAgICAgICAgICAgIGxpbms6IHVwZGF0ZWRSZXN1bHQubGluayxcbiAgICAgICAgICAgIGltYWdlOiB1cGRhdGVkUmVzdWx0LmltYWdlLFxuICAgICAgICAgICAgZ29vZ2xlX2lkOiB1cGRhdGVkUmVzdWx0Lmdvb2dsZV9pZCxcbiAgICAgICAgICAgIHR5cGU6IHVwZGF0ZWRSZXN1bHQudHlwZSxcbiAgICAgICAgICAgIGxvY2F0aW9uOiB1cGRhdGVkUmVzdWx0LmxvY2F0aW9uLFxuICAgICAgICAgICAgc3RhdHVzOiB1cGRhdGVkUmVzdWx0LnN0YXR1cyxcbiAgICAgICAgICAgIHJhdGluZzogdXBkYXRlZFJlc3VsdC5yYXRpbmdcbiAgICAgICAgICB9KTtcbiAgICAgICAgICBfY29udGV4dDQubmV4dCA9IDE4O1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlIDE0OlxuICAgICAgICAgIF9jb250ZXh0NC5wcmV2ID0gMTQ7XG4gICAgICAgICAgX2NvbnRleHQ0LnQwID0gX2NvbnRleHQ0W1wiY2F0Y2hcIl0oNSk7XG4gICAgICAgICAgY29uc29sZS5lcnJvcihfY29udGV4dDQudDApO1xuICAgICAgICAgIG5leHQoX2NvbnRleHQ0LnQwKTtcbiAgICAgICAgY2FzZSAxODpcbiAgICAgICAgY2FzZSBcImVuZFwiOlxuICAgICAgICAgIHJldHVybiBfY29udGV4dDQuc3RvcCgpO1xuICAgICAgfVxuICAgIH0sIF9jYWxsZWU0LCBudWxsLCBbWzUsIDE0XV0pO1xuICB9KSk7XG4gIHJldHVybiBmdW5jdGlvbiAoX3gxMCwgX3gxMSwgX3gxMikge1xuICAgIHJldHVybiBfcmVmNC5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICB9O1xufSgpKTtcbnZhciBfZGVmYXVsdCA9IGV4cG9ydHNbXCJkZWZhdWx0XCJdID0gQm9va3NSb3V0ZXI7Il0sIm1hcHBpbmdzIjoiQUFBQSxZQUFZOztBQUVaLElBQUlBLHNCQUFzQixHQUFHQyxPQUFPLENBQUMsOENBQThDLENBQUM7QUFDcEZDLE1BQU0sQ0FBQ0MsY0FBYyxDQUFDQyxPQUFPLEVBQUUsWUFBWSxFQUFFO0VBQzNDQyxLQUFLLEVBQUU7QUFDVCxDQUFDLENBQUM7QUFDRkQsT0FBTyxDQUFDLFNBQVMsQ0FBQyxHQUFHLEtBQUssQ0FBQztBQUMzQixJQUFJRSxZQUFZLEdBQUdOLHNCQUFzQixDQUFDQyxPQUFPLENBQUMsNEJBQTRCLENBQUMsQ0FBQztBQUNoRixJQUFJTSxnQkFBZ0IsR0FBR1Asc0JBQXNCLENBQUNDLE9BQU8sQ0FBQyx1Q0FBdUMsQ0FBQyxDQUFDO0FBQy9GLElBQUlPLGtCQUFrQixHQUFHUixzQkFBc0IsQ0FBQ0MsT0FBTyxDQUFDLHlDQUF5QyxDQUFDLENBQUM7QUFDbkcsSUFBSVEsUUFBUSxHQUFHVCxzQkFBc0IsQ0FBQ0MsT0FBTyxDQUFDLFNBQVMsQ0FBQyxDQUFDO0FBQ3pELElBQUlTLE1BQU0sR0FBR1Ysc0JBQXNCLENBQUNDLE9BQU8sQ0FBQyxrQ0FBa0MsQ0FBQyxDQUFDO0FBQ2hGLFNBQVNVLE9BQU9BLENBQUNDLENBQUMsRUFBRUMsQ0FBQyxFQUFFO0VBQ3JCLElBQUlDLENBQUMsR0FBR1osTUFBTSxDQUFDYSxJQUFJLENBQUNILENBQUMsQ0FBQztFQUN0QixJQUFJVixNQUFNLENBQUNjLHFCQUFxQixFQUFF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
{"version":3,"file":"auth.routes.js","names":["AuthRouter","express","Router","redirectUrl","process","env","CLIENT_URL","get","passport","authenticate","scope","failureRedirect","_ref","_asyncToGenerator2","_regenerator","mark","_callee","req","res","wrap","_callee$","_context","prev","next","console","log","user","redirect","stop","_x","_x2","apply","arguments","_ref2","_callee2","_callee2$","_context2","isAuthenticated","json","status","message","_x3","_x4","post","logout","err","session","_default","_exports"],"sources":["../../routes/auth.routes.js"],"sourcesContent":["// Using Google OAuth to sign in \nimport express from \"express\";\nimport passport from \"passport\";// Used Passport Library - middleware for handling authentication\n\nconst AuthRouter = express.Router();\n\nconst redirectUrl = process.env.CLIENT_URL || 'http://localhost:8080/'; // Use the environment variable\n\n// Redirect to Google for authentication\nAuthRouter.get('/google', passport.authenticate('google', { \n    scope: ['profile', 'email'], \n    // prompt: 'select_account' // This will prompt the user to select an account each time they sign in \n}));\n\n// Callback route for Google to redirect to\nAuthRouter.get('/google/callback', \n    passport.authenticate('google', { failureRedirect: '/' }),\n    async (req, res) => {\n        console.log('Authenticated User:', req.user);\n        res.redirect(redirectUrl); // Redirect to the account/home page (Client side) after auth\n    }\n);\n\n// User profile route\nAuthRouter.get('/profile', async (req, res) => {\n    if (req.isAuthenticated()) {\n        res.json(req.user); // Return the authenticated user\n    } else {\n        res.status(401).json({ message: 'User not authenticated' });\n    }\n});\n\n// Logout endpoint\nAuthRouter.post('/logout', (req, res) => {\n    req.logout((err) => {\n        if (err) return next(err);\n        req.session = null; // Clear session data\n        res.redirect('/loggedout'); // Redirect after logout\n    });\n});\n\nexport default AuthRouter;"],"mappings":"0mCAAA;;EAEgC;;EAEhC,IAAMA,UAAU,GAAGC,mBAAO,CAACC,MAAM,CAAC,CAAC;;EAEnC,IAAMC,WAAW,GAAGC,OAAO,CAACC,GAAG,CAACC,UAAU,IAAI,wBAAwB,CAAC,CAAC;;EAExE;EACAN,UAAU,CAACO,GAAG,CAAC,SAAS,EAAEC,oBAAQ,CAACC,YAAY,CAAC,QAAQ,EAAE;IACtDC,KAAK,EAAE,CAAC,SAAS,EAAE,OAAO;IAC1B;EACJ,CAAC,CAAC,CAAC;;EAEH;EACAV,UAAU,CAACO,GAAG,CAAC,kBAAkB;EAC7BC,oBAAQ,CAACC,YAAY,CAAC,QAAQ,EAAE,EAAEE,eAAe,EAAE,GAAG,CAAC,CAAC,CAAC,gCAAAC,IAAA,OAAAC,kBAAA,0BAAAC,YAAA,YAAAC,IAAA;MACzD,SAAAC,QAAOC,GAAG,EAAEC,GAAG,UAAAJ,YAAA,YAAAK,IAAA,UAAAC,SAAAC,QAAA,qBAAAA,QAAA,CAAAC,IAAA,GAAAD,QAAA,CAAAE,IAAA;cACXC,OAAO,CAACC,GAAG,CAAC,qBAAqB,EAAER,GAAG,CAACS,IAAI,CAAC;cAC5CR,GAAG,CAACS,QAAQ,CAACxB,WAAW,CAAC,CAAC,CAAC;YAAA,yBAAAkB,QAAA,CAAAO,IAAA,OAAAZ,OAAA,GAC9B,oBAAAa,EAAA,EAAAC,GAAA,UAAAlB,IAAA,CAAAmB,KAAA,OAAAC,SAAA;EACL,CAAC;;EAED;EACAhC,UAAU,CAACO,GAAG,CAAC,UAAU,gCAAA0B,KAAA,OAAApB,kBAAA,0BAAAC,YAAA,YAAAC,IAAA,CAAE,SAAAmB,SAAOjB,GAAG,EAAEC,GAAG,UAAAJ,YAAA,YAAAK,IAAA,UAAAgB,UAAAC,SAAA,qBAAAA,SAAA,CAAAd,IAAA,GAAAc,SAAA,CAAAb,IAAA;YACtC,IAAIN,GAAG,CAACoB,eAAe,CAAC,CAAC,EAAE;cACvBnB,GAAG,CAACoB,IAAI,CAACrB,GAAG,CAACS,IAAI,CAAC,CAAC,CAAC;YACxB,CAAC,MAAM;cACHR,GAAG,CAACqB,MAAM,CAAC,GAAG,CAAC,CAACD,IAAI,CAAC,EAAEE,OAAO,EAAE,wBAAwB,CAAC,CAAC,CAAC;YAC/D,CAAC,yBAAAJ,SAAA,CAAAR,IAAA,OAAAM,QAAA,GACJ,oBAAAO,GAAA,EAAAC,GAAA,UAAAT,KAAA,CAAAF,KAAA,OAAAC,SAAA;EAAA,CAAC;;EAEF;EACAhC,UAAU,CAAC2C,IAAI,CAAC,SAAS,EAAE,UAAC1B,GAAG,EAAEC,GAAG,EAAK;IACrCD,GAAG,CAAC2B,MAAM,CAAC,UAACC,GAAG,EAAK;MAChB,IAAIA,GAAG,EAAE,OAAOtB,IAAI,CAACsB,GAAG,CAAC;MACzB5B,GAAG,CAAC6B,OAAO,GAAG,IAAI,CAAC,CAAC;MACpB5B,GAAG,CAACS,QAAQ,CAAC,YAAY,CAAC,CAAC,CAAC;IAChC,CAAC,CAAC;EACN,CAAC,CAAC,CAAC,IAAAoB,QAAA,GAAAC,QAAA;;EAEYhD,UAAU","ignoreList":[]}